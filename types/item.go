package types

import (
	"bytes"
	"io"

	"github.com/L7-MCPE/lav7/util/buffer"
	"github.com/minero/minero-go/proto/nbt"
)

// CreativeItems is a list of inventory items for creative mode players.
var CreativeItems = []Item{
	{ID: 4, Meta: 0},
	{ID: 98, Meta: 0},
	{ID: 98, Meta: 1},
	{ID: 98, Meta: 2},
	{ID: 98, Meta: 3},
	{ID: 48, Meta: 0},
	{ID: 5, Meta: 0},
	{ID: 5, Meta: 1},
	{ID: 5, Meta: 2},
	{ID: 5, Meta: 3},
	{ID: 5, Meta: 4},
	{ID: 5, Meta: 5},
	{ID: 45, Meta: 0},
	{ID: 1, Meta: 0},
	{ID: 1, Meta: 1},
	{ID: 1, Meta: 2},
	{ID: 1, Meta: 3},
	{ID: 1, Meta: 4},
	{ID: 1, Meta: 5},
	{ID: 1, Meta: 6},
	{ID: 3, Meta: 0},
	{ID: 243, Meta: 0},
	{ID: 2, Meta: 0},
	{ID: 110, Meta: 0},
	{ID: 82, Meta: 0},
	{ID: 172, Meta: 0},
	{ID: 159, Meta: 0},
	{ID: 159, Meta: 1},
	{ID: 159, Meta: 2},
	{ID: 159, Meta: 3},
	{ID: 159, Meta: 4},
	{ID: 159, Meta: 5},
	{ID: 159, Meta: 6},
	{ID: 159, Meta: 7},
	{ID: 159, Meta: 8},
	{ID: 159, Meta: 9},
	{ID: 159, Meta: 10},
	{ID: 159, Meta: 11},
	{ID: 159, Meta: 12},
	{ID: 159, Meta: 13},
	{ID: 159, Meta: 14},
	{ID: 159, Meta: 15},
	{ID: 24, Meta: 0},
	{ID: 24, Meta: 1},
	{ID: 24, Meta: 2},
	{ID: 12, Meta: 0},
	{ID: 12, Meta: 1},
	{ID: 13, Meta: 0},
	{ID: 17, Meta: 0},
	{ID: 17, Meta: 1},
	{ID: 17, Meta: 2},
	{ID: 17, Meta: 3},
	{ID: 162, Meta: 0},
	{ID: 162, Meta: 1},
	{ID: 112, Meta: 0},
	{ID: 87, Meta: 0},
	{ID: 88, Meta: 0},
	{ID: 7, Meta: 0},
	{ID: 67, Meta: 0},
	{ID: 53, Meta: 0},
	{ID: 134, Meta: 0},
	{ID: 135, Meta: 0},
	{ID: 136, Meta: 0},
	{ID: 163, Meta: 0},
	{ID: 164, Meta: 0},
	{ID: 108, Meta: 0},
	{ID: 128, Meta: 0},
	{ID: 109, Meta: 0},
	{ID: 114, Meta: 0},
	{ID: 156, Meta: 0},
	{ID: 44, Meta: 0},
	{ID: 44, Meta: 1},
	{ID: 158, Meta: 0},
	{ID: 158, Meta: 1},
	{ID: 158, Meta: 2},
	{ID: 158, Meta: 3},
	{ID: 158, Meta: 4},
	{ID: 158, Meta: 5},
	{ID: 44, Meta: 3},
	{ID: 44, Meta: 4},
	{ID: 44, Meta: 5},
	{ID: 44, Meta: 6},
	{ID: 44, Meta: 7},
	{ID: 155, Meta: 0},
	{ID: 155, Meta: 1},
	{ID: 155, Meta: 2},
	{ID: 16, Meta: 0},
	{ID: 15, Meta: 0},
	{ID: 14, Meta: 0},
	{ID: 56, Meta: 0},
	{ID: 21, Meta: 0},
	{ID: 73, Meta: 0},
	{ID: 129, Meta: 0},
	{ID: 49, Meta: 0},
	{ID: 79, Meta: 0},
	{ID: 174, Meta: 0},
	{ID: 80, Meta: 0},
	{ID: 121, Meta: 0},
	{ID: 139, Meta: 0},
	{ID: 139, Meta: 1},
	{ID: 111, Meta: 0},
	{ID: 41, Meta: 0},
	{ID: 42, Meta: 0},
	{ID: 57, Meta: 0},
	{ID: 22, Meta: 0},
	{ID: 173, Meta: 0},
	{ID: 133, Meta: 0},
	{ID: 152, Meta: 0},
	{ID: 78, Meta: 0},
	{ID: 20, Meta: 0},
	{ID: 89, Meta: 0},
	{ID: 106, Meta: 0},
	{ID: 65, Meta: 0},
	{ID: 19, Meta: 0},
	{ID: 102, Meta: 0},
	{ID: 324, Meta: 0},
	{ID: 324, Meta: 0},
	{ID: 324, Meta: 0},
	{ID: 324, Meta: 0},
	{ID: 324, Meta: 0},
	{ID: 324, Meta: 0},
	{ID: 330, Meta: 0},
	{ID: 96, Meta: 0},
	{ID: 167, Meta: 0},
	{ID: 85, Meta: 0},
	{ID: 85, Meta: 1},
	{ID: 85, Meta: 2},
	{ID: 85, Meta: 3},
	{ID: 85, Meta: 4},
	{ID: 85, Meta: 5},
	{ID: 113, Meta: 0},
	{ID: 107, Meta: 0},
	{ID: 183, Meta: 0},
	{ID: 184, Meta: 0},
	{ID: 185, Meta: 0},
	{ID: 187, Meta: 0},
	{ID: 186, Meta: 0},
	{ID: 101, Meta: 0},
	{ID: 355, Meta: 0},
	{ID: 47, Meta: 0},
	{ID: 321, Meta: 0},
	{ID: 58, Meta: 0},
	{ID: 245, Meta: 0},
	{ID: 54, Meta: 0},
	{ID: 54, Meta: 0},
	{ID: 61, Meta: 0},
	{ID: 379, Meta: 0},
	{ID: 120, Meta: 0},
	{ID: 145, Meta: 0},
	{ID: 145, Meta: 4},
	{ID: 145, Meta: 8},
	{ID: 37, Meta: 0},
	{ID: 38, Meta: 0},
	{ID: 38, Meta: 1},
	{ID: 38, Meta: 2},
	{ID: 38, Meta: 3},
	{ID: 38, Meta: 4},
	{ID: 38, Meta: 5},
	{ID: 38, Meta: 6},
	{ID: 38, Meta: 7},
	{ID: 38, Meta: 8},
	{ID: 39, Meta: 0},
	{ID: 40, Meta: 0},
	{ID: 81, Meta: 0},
	{ID: 103, Meta: 0},
	{ID: 86, Meta: 0},
	{ID: 91, Meta: 0},
	{ID: 30, Meta: 0},
	{ID: 170, Meta: 0},
	{ID: 31, Meta: 1},
	{ID: 31, Meta: 2},
	{ID: 32, Meta: 0},
	{ID: 6, Meta: 0},
	{ID: 6, Meta: 1},
	{ID: 6, Meta: 2},
	{ID: 6, Meta: 3},
	{ID: 6, Meta: 4},
	{ID: 6, Meta: 5},
	{ID: 18, Meta: 0},
	{ID: 18, Meta: 1},
	{ID: 18, Meta: 2},
	{ID: 18, Meta: 3},
	{ID: 161, Meta: 0},
	{ID: 161, Meta: 1},
	{ID: 354, Meta: 0},
	{ID: 323, Meta: 0},
	{ID: 390, Meta: 0},
	{ID: 52, Meta: 0},
	{ID: 116, Meta: 0},
	{ID: 35, Meta: 0},
	{ID: 35, Meta: 7},
	{ID: 35, Meta: 6},
	{ID: 35, Meta: 5},
	{ID: 35, Meta: 4},
	{ID: 35, Meta: 3},
	{ID: 35, Meta: 2},
	{ID: 35, Meta: 1},
	{ID: 35, Meta: 15},
	{ID: 35, Meta: 14},
	{ID: 35, Meta: 13},
	{ID: 35, Meta: 12},
	{ID: 35, Meta: 11},
	{ID: 35, Meta: 10},
	{ID: 35, Meta: 9},
	{ID: 35, Meta: 8},
	{ID: 171, Meta: 0},
	{ID: 171, Meta: 7},
	{ID: 171, Meta: 6},
	{ID: 171, Meta: 5},
	{ID: 171, Meta: 4},
	{ID: 171, Meta: 3},
	{ID: 171, Meta: 2},
	{ID: 171, Meta: 1},
	{ID: 171, Meta: 15},
	{ID: 171, Meta: 14},
	{ID: 171, Meta: 13},
	{ID: 171, Meta: 12},
	{ID: 171, Meta: 11},
	{ID: 171, Meta: 10},
	{ID: 171, Meta: 9},
	{ID: 171, Meta: 8},
	{ID: 139, Meta: 0},
	{ID: 139, Meta: 1},
	{ID: 111, Meta: 0},
	{ID: 41, Meta: 0},
	{ID: 42, Meta: 0},
	{ID: 57, Meta: 0},
	{ID: 22, Meta: 0},
	{ID: 173, Meta: 0},
	{ID: 133, Meta: 0},
	{ID: 152, Meta: 0},
	{ID: 78, Meta: 0},
	{ID: 20, Meta: 0},
	{ID: 89, Meta: 0},
	{ID: 106, Meta: 0},
	{ID: 65, Meta: 0},
	{ID: 19, Meta: 0},
	{ID: 102, Meta: 0},
	{ID: 324, Meta: 0},
	{ID: 324, Meta: 0},
	{ID: 324, Meta: 0},
	{ID: 324, Meta: 0},
	{ID: 324, Meta: 0},
	{ID: 324, Meta: 0},
	{ID: 330, Meta: 0},
	{ID: 96, Meta: 0},
	{ID: 167, Meta: 0},
	{ID: 85, Meta: 0},
	{ID: 85, Meta: 1},
	{ID: 85, Meta: 2},
	{ID: 85, Meta: 3},
	{ID: 85, Meta: 4},
	{ID: 85, Meta: 5},
	{ID: 113, Meta: 0},
	{ID: 107, Meta: 0},
	{ID: 183, Meta: 0},
	{ID: 184, Meta: 0},
	{ID: 185, Meta: 0},
	{ID: 187, Meta: 0},
	{ID: 186, Meta: 0},
	{ID: 101, Meta: 0},
	{ID: 355, Meta: 0},
	{ID: 47, Meta: 0},
	{ID: 321, Meta: 0},
	{ID: 58, Meta: 0},
	{ID: 245, Meta: 0},
	{ID: 54, Meta: 0},
	{ID: 54, Meta: 0},
	{ID: 61, Meta: 0},
	{ID: 379, Meta: 0},
	{ID: 120, Meta: 0},
	{ID: 145, Meta: 0},
	{ID: 145, Meta: 4},
	{ID: 145, Meta: 8},
	{ID: 37, Meta: 0},
	{ID: 38, Meta: 0},
	{ID: 38, Meta: 1},
	{ID: 38, Meta: 2},
	{ID: 38, Meta: 3},
	{ID: 38, Meta: 4},
	{ID: 38, Meta: 5},
	{ID: 38, Meta: 6},
	{ID: 38, Meta: 7},
	{ID: 38, Meta: 8},
	{ID: 39, Meta: 0},
	{ID: 40, Meta: 0},
	{ID: 81, Meta: 0},
	{ID: 103, Meta: 0},
	{ID: 86, Meta: 0},
	{ID: 91, Meta: 0},
	{ID: 30, Meta: 0},
	{ID: 170, Meta: 0},
	{ID: 31, Meta: 1},
	{ID: 31, Meta: 2},
	{ID: 32, Meta: 0},
	{ID: 6, Meta: 0},
	{ID: 6, Meta: 1},
	{ID: 6, Meta: 2},
	{ID: 6, Meta: 3},
	{ID: 6, Meta: 4},
	{ID: 6, Meta: 5},
	{ID: 18, Meta: 0},
	{ID: 18, Meta: 1},
	{ID: 18, Meta: 2},
	{ID: 18, Meta: 3},
	{ID: 161, Meta: 0},
	{ID: 161, Meta: 1},
	{ID: 354, Meta: 0},
	{ID: 323, Meta: 0},
	{ID: 390, Meta: 0},
	{ID: 52, Meta: 0},
	{ID: 116, Meta: 0},
	{ID: 35, Meta: 0},
	{ID: 35, Meta: 7},
	{ID: 35, Meta: 6},
	{ID: 35, Meta: 5},
	{ID: 35, Meta: 4},
	{ID: 35, Meta: 3},
	{ID: 35, Meta: 2},
	{ID: 35, Meta: 1},
	{ID: 35, Meta: 15},
	{ID: 35, Meta: 14},
	{ID: 35, Meta: 13},
	{ID: 35, Meta: 12},
	{ID: 35, Meta: 11},
	{ID: 35, Meta: 10},
	{ID: 35, Meta: 9},
	{ID: 35, Meta: 8},
	{ID: 171, Meta: 0},
	{ID: 171, Meta: 7},
	{ID: 171, Meta: 6},
	{ID: 171, Meta: 5},
	{ID: 171, Meta: 4},
	{ID: 171, Meta: 3},
	{ID: 171, Meta: 2},
	{ID: 171, Meta: 1},
	{ID: 171, Meta: 15},
	{ID: 171, Meta: 14},
	{ID: 171, Meta: 13},
	{ID: 171, Meta: 12},
	{ID: 171, Meta: 11},
	{ID: 171, Meta: 10},
	{ID: 171, Meta: 9},
	{ID: 171, Meta: 8},
	{ID: 50, Meta: 0},
	{ID: 325, Meta: 0},
	{ID: 325, Meta: 1},
	{ID: 325, Meta: 8},
	{ID: 325, Meta: 10},
	{ID: 46, Meta: 0},
	{ID: 331, Meta: 0},
	{ID: 261, Meta: 0},
	{ID: 346, Meta: 0},
	{ID: 259, Meta: 0},
	{ID: 359, Meta: 0},
	{ID: 347, Meta: 0},
	{ID: 345, Meta: 0},
	{ID: 328, Meta: 0},
	{ID: 383, Meta: 15},
	{ID: 383, Meta: 32},
	{ID: 383, Meta: 17},
	{ID: 268, Meta: 0},
	{ID: 290, Meta: 0},
	{ID: 269, Meta: 0},
	{ID: 270, Meta: 0},
	{ID: 271, Meta: 0},
	{ID: 272, Meta: 0},
	{ID: 291, Meta: 0},
	{ID: 273, Meta: 0},
	{ID: 274, Meta: 0},
	{ID: 275, Meta: 0},
	{ID: 267, Meta: 0},
	{ID: 292, Meta: 0},
	{ID: 256, Meta: 0},
	{ID: 257, Meta: 0},
	{ID: 258, Meta: 0},
	{ID: 276, Meta: 0},
	{ID: 293, Meta: 0},
	{ID: 277, Meta: 0},
	{ID: 278, Meta: 0},
	{ID: 279, Meta: 0},
	{ID: 283, Meta: 0},
	{ID: 294, Meta: 0},
	{ID: 284, Meta: 0},
	{ID: 285, Meta: 0},
	{ID: 286, Meta: 0},
	{ID: 298, Meta: 0},
	{ID: 299, Meta: 0},
	{ID: 300, Meta: 0},
	{ID: 301, Meta: 0},
	{ID: 302, Meta: 0},
	{ID: 303, Meta: 0},
	{ID: 304, Meta: 0},
	{ID: 305, Meta: 0},
	{ID: 306, Meta: 0},
	{ID: 307, Meta: 0},
	{ID: 308, Meta: 0},
	{ID: 309, Meta: 0},
	{ID: 310, Meta: 0},
	{ID: 311, Meta: 0},
	{ID: 312, Meta: 0},
	{ID: 313, Meta: 0},
	{ID: 314, Meta: 0},
	{ID: 315, Meta: 0},
	{ID: 316, Meta: 0},
	{ID: 317, Meta: 0},
	{ID: 332, Meta: 0},
	{ID: 263, Meta: 0},
	{ID: 263, Meta: 1},
	{ID: 264, Meta: 0},
	{ID: 265, Meta: 0},
	{ID: 266, Meta: 0},
	{ID: 388, Meta: 0},
	{ID: 280, Meta: 0},
	{ID: 281, Meta: 0},
	{ID: 287, Meta: 0},
	{ID: 288, Meta: 0},
	{ID: 318, Meta: 0},
	{ID: 334, Meta: 0},
	{ID: 337, Meta: 0},
	{ID: 353, Meta: 0},
	{ID: 406, Meta: 0},
	{ID: 339, Meta: 0},
	{ID: 340, Meta: 0},
	{ID: 262, Meta: 0},
	{ID: 352, Meta: 0},
	{ID: 338, Meta: 0},
	{ID: 296, Meta: 0},
	{ID: 295, Meta: 0},
	{ID: 361, Meta: 0},
	{ID: 362, Meta: 0},
	{ID: 458, Meta: 0},
	{ID: 344, Meta: 0},
	{ID: 260, Meta: 0},
	{ID: 322, Meta: 0},
	{ID: 349, Meta: 0},
	{ID: 349, Meta: 1},
	{ID: 349, Meta: 2},
	{ID: 349, Meta: 3},
	{ID: 350, Meta: 0},
	{ID: 350, Meta: 1},
	{ID: 297, Meta: 0},
	{ID: 319, Meta: 0},
	{ID: 320, Meta: 0},
	{ID: 365, Meta: 0},
	{ID: 366, Meta: 0},
	{ID: 363, Meta: 0},
	{ID: 364, Meta: 0},
	{ID: 360, Meta: 0},
	{ID: 391, Meta: 0},
	{ID: 392, Meta: 0},
	{ID: 393, Meta: 0},
	{ID: 357, Meta: 0},
	{ID: 400, Meta: 0},
	{ID: 371, Meta: 0},
	{ID: 341, Meta: 0},
	{ID: 289, Meta: 0},
	{ID: 348, Meta: 0},
	{ID: 351, Meta: 0},
	{ID: 351, Meta: 7},
	{ID: 351, Meta: 6},
	{ID: 351, Meta: 5},
	{ID: 351, Meta: 4},
	{ID: 351, Meta: 3},
	{ID: 351, Meta: 2},
	{ID: 351, Meta: 1},
	{ID: 351, Meta: 15},
	{ID: 351, Meta: 14},
	{ID: 351, Meta: 13},
	{ID: 351, Meta: 12},
	{ID: 351, Meta: 11},
	{ID: 351, Meta: 10},
	{ID: 351, Meta: 9},
	{ID: 351, Meta: 8},
}

// Item contains item data for each container slots.
type Item struct {
	ID       ID
	Meta     uint16
	Amount   byte
	Compound *nbt.Compound
}

// Read reads item data from io.Reader interface.
func (i *Item) Read(buf io.Reader) {
	i.ID = ID(buffer.ReadShort(buf))
	if i.ID == 0 {
		return
	}
	i.Amount = buffer.ReadByte(buf)
	i.Meta = buffer.ReadShort(buf)
	length := uint32(buffer.ReadLShort(buf))
	if length > 0 {
		b, _ := buffer.Read(buf, int(length))
		compound := bytes.NewBuffer(b)
		i.Compound = new(nbt.Compound)
		i.Compound.ReadFrom(compound)
	}
}

// Write returns byte slice with item data.
func (i Item) Write() []byte {
	if i.ID == 0 {
		return []byte{0, 0}
	}
	buf := new(bytes.Buffer)
	buffer.WriteShort(buf, uint16(i.ID))
	buffer.WriteByte(buf, i.Amount)
	buffer.WriteShort(buf, i.Meta)
	compound := new(bytes.Buffer)
	i.Compound = new(nbt.Compound)
	i.Compound.WriteTo(compound)
	buffer.WriteLShort(buf, uint16(compound.Len()))
	buf.Write(compound.Bytes())
	return buf.Bytes()
}

// Block converts the item to block struct.
// If ID is not a block ID, it panics.
func (i Item) Block() Block {
	return Block{
		ID:   i.ID.Block(),
		Meta: byte(i.Meta),
	}
}

// IsBlock returns whether the item block-convertable.
func (i Item) IsBlock() bool {
	return i.ID < 256
}
